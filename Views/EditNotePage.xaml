<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:TaskFlow.ViewModels"
             x:Class="TaskFlow.EditNotePage"
             BackgroundColor="Black"
             Title="Edit Note">
    <ContentPage.Resources>
        <vm:StarImageConverter x:Key="StarImageConverter" />
    </ContentPage.Resources>
    <Grid RowDefinitions="Auto,*">
        <!-- Back Button -->
        <AbsoluteLayout Grid.Row="0" IsClippedToBounds="False">
            <Border
                HeightRequest="50"
                WidthRequest="50"
                StrokeShape="RoundRectangle 50"
                StrokeThickness="0"
                BackgroundColor="White"
                Margin="20,20,0,20"
                AbsoluteLayout.LayoutBounds="0,0,AutoSize,AutoSize"
                AbsoluteLayout.LayoutFlags="PositionProportional">
                <ImageButton
                    Command="{Binding BackCommand}"
                    Source="back.png"
                    BackgroundColor="Transparent"
                    HeightRequest="40"
                    WidthRequest="40"/>
            </Border>
        </AbsoluteLayout>

        <!-- Main content -->
        <VerticalStackLayout Grid.Row="1" Padding="24" Spacing="16">
            <Entry Text="{Binding Title}" Placeholder="Title" x:Name="TitleEntry" FontSize="24" TextColor="White"/>
            <Editor Text="{Binding Content}" Placeholder="Content" x:Name="ContentEditor" FontSize="18" TextColor="White"
                    HeightRequest="200" AutoSize="TextChanges"/>
            <Label Text="{Binding Timestamp}" FontSize="12" TextColor="Gray"/>
            <Grid ColumnDefinitions="Auto,*,Auto" Padding="0">
                <ImageButton
                    Source="{Binding IsStarred, Converter={StaticResource StarImageConverter}}"
                    BackgroundColor="Gold"
                    WidthRequest="50"
                    HeightRequest="50"
                    Padding="0"
                    Aspect="AspectFit"
                    Command="{Binding StarCommand}"
                    CornerRadius="10"
                    HorizontalOptions="Start"
                    Grid.Column="0"/>
                <Button Text="Save"
                        Command="{Binding SaveCommand}"
                        HorizontalOptions="Center"
                        WidthRequest="70"
                        HeightRequest="50"
                        Padding="10"
                        Grid.Column="1"/>
                <Button Text="Delete"
                        Command="{Binding DeleteCommand}"
                        HorizontalOptions="End"
                        WidthRequest="70"
                        HeightRequest="50"
                        Padding="10"
                        Grid.Column="2"/>
            </Grid>
        </VerticalStackLayout>
    </Grid>
</ContentPage>